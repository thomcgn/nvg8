services:
  postgres:
    container_name: nvg8-prod-postgres
    # in Prod KEIN Port nach außen

  backend:
    container_name: nvg8-prod-backend
    environment:
      SPRING_PROFILES_ACTIVE: prod

      # Prod: Cookies cross-site fähig für HTTPS (SameSite=None + Secure)
      APP_DEV_MODE: "false"
      APP_COOKIE_DOMAIN: ".witchplease.de"
      APP_COOKIE_SECURE: "true"
      APP_COOKIE_SAMESITE: "None"

      # Prod: Bootstrap normalerweise AUS (sonst überschreibst du dir Accounts/Passwörter)
      APP_BOOTSTRAP_ADMIN: "false"

      # Prod: CORS nur Domain
      CORS_ALLOWED_ORIGINS: "https://nvg8.witchplease.de"
      CORS_ALLOWED_METHODS: "GET,POST,PUT,PATCH,DELETE,OPTIONS"
      CORS_ALLOW_CREDENTIALS: "true"

    ports:
      - "127.0.0.1:8080:8080"

  frontend:
    container_name: nvg8-prod-frontend
    environment:
      BACKEND_URL: "http://backend:8080"
    ports:
      - "127.0.0.1:3000:3000"

volumes:
  postgres_data:
    name: nvg8_prod_postgres_data
